<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ANHBAO Store</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0a0a0a" />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    html, body { height: 100%; margin:0; background-color: #0a0a0a; font-family: 'SamsungOne', sans-serif; color: #fff; }
    header { display: flex; align-items: center; justify-content: space-between; padding: 1rem 2rem; background-color: #111; border-bottom: 2px solid #444; }
    header h1 { font-size: 1.8rem; font-weight: 700; letter-spacing: 1px; color:#00a8ff; display:flex; align-items:center; gap:0.6rem; }
    .search-container { position: relative; width: 350px; }
    .search-input { width: 100%; padding: 0.6rem 1rem 0.6rem 2.5rem; border-radius: 9999px; border: none; outline: none; font-size: 1.1rem; background: #222; color: #fff; transition: all 0.3s; }
    .search-input:focus { background: #333; box-shadow: 0 0 10px #00a8ff; }
    .rows-container { padding: 1rem; display: flex; flex-direction: column; gap: 3rem; }
    .row { display: flex; flex-direction: column; gap: 1rem; }
    .row-title { font-size: 1.5rem; font-weight: 700; margin-left: 0.5rem; color: #00a8ff; }
    .row-scroll { display: flex; gap: 1.5rem; flex-wrap: wrap; }
    .tv-card { width: 320px; height: 180px; border-radius: 0.5rem; overflow: hidden; background-color: #222; transition: transform 0.3s, box-shadow 0.3s; flex-shrink: 0; position: relative; }
    .tv-card img { width: 100%; height: 100%; object-fit: cover; border-radius: 0.5rem; }
    .tv-card:focus { transform: scale(1.1); box-shadow: 0 0 20px #00a8ff; outline: none; z-index: 20; }
    .card-label { position: absolute; bottom: 0; width: 100%; background: linear-gradient(0deg, rgba(0,0,0,0.7), transparent); padding: 0.6rem; font-size: 1rem; font-weight: 700; color: #00a8ff; text-align: center; }
    .details-panel { position: fixed; inset:0; display: none; align-items: center; justify-content: center; background: rgba(0,0,0,0.9); backdrop-filter: blur(10px); padding: 2rem; }
    .details-content { background-color: #111; border-radius: 1rem; padding: 2rem; max-width: 1000px; width: 100%; display: flex; gap: 2rem; }
    .details-content img { width: 360px; height: 200px; object-fit: cover; border-radius: 0.5rem; border: 2px solid #00a8ff; }
    .details-info { flex: 1; display: flex; flex-direction: column; gap: 0.5rem; }
    .details-info h2 { font-size: 1.8rem; font-weight: 700; color: #00a8ff; }
    .details-info a { margin-top: auto; background-color: #00a8ff; padding: 0.7rem 1.4rem; border-radius: 0.5rem; font-weight: 700; color: #000; text-align:center; text-decoration:none; }
    footer { background:#111; border-top:2px solid #333; text-align:center; padding:1rem; font-size:1rem; color:#bbb; }
    footer a { color:#00a8ff; }
  </style>
</head>
<body>
  <header>
    <h1><span style="display:inline-block;width:32px;height:32px;background:#00a8ff;border-radius:4px;"></span> ANHBAO Store</h1>
    <div class="search-container">
      <input type="text" id="searchInput" class="search-input" placeholder="Tìm ứng dụng yêu thích..." />
    </div>
  </header>
  <main class="rows-container" id="rows"></main>
  <div id="details" class="details-panel">
    <div class="details-content">
      <img id="detailsPoster" src="" alt="Poster">
      <div class="details-info">
        <h2 id="detailsTitle">Tên ứng dụng</h2>
        <p id="detailsDev">Nhà phát triển</p>
        <p id="detailsDesc">Mô tả</p>
        <a id="installLink" href="#" target="_blank">Cài đặt</a>
      </div>
    </div>
  </div>
  <footer>
    <p>Liên hệ: <a href="mailto:anhbao.store@gmail.com">anhbao.store@gmail.com</a></p>
    <p>© 2025 ANHBAO Store. Mọi quyền được bảo lưu.</p>
  </footer>
  <script>
    async function safeFetchJSON(path, fallback) {
      try { const res = await fetch(path); if (!res.ok) throw 0; return await res.json(); }
      catch { return fallback; }
    }
    async function loadData() {
      const appsDefault = { apps: [ { title:"YouTube", poster:"https://i.imgur.com/4ZQZ4Yb.jpg", dev:"Google LLC", desc:"Xem video trực tuyến", url:"https://youtube.com" } ] };
      const rowsDefault = { rows: [ { title:"Ứng dụng phổ biến", apps:[0] } ] };
      const [apps, rows] = await Promise.all([ safeFetchJSON('apps.json', appsDefault), safeFetchJSON('rows.json', rowsDefault) ]);
      const combined = rows.rows.map(r => ({ title:r.title, apps:r.apps.map(i=>apps.apps[i]) }));
      renderRows(combined);
    }
    function createCard(app){
      const btn=document.createElement('button'); btn.className='tv-card'; btn.tabIndex=0;
      btn.innerHTML=`<img src='${app.poster}'><div class='card-label'>${app.title}</div>`;
      btn.onclick=()=>openDetails(app);
      btn.onfocus=()=>btn.scrollIntoView({behavior:'smooth',inline:'center'});
      return btn;
    }
    function renderRows(data){
      const rowsEl=document.getElementById('rows'); rowsEl.innerHTML='';
      data.forEach(r=>{ const div=document.createElement('div'); div.className='row';
        const t=document.createElement('div'); t.className='row-title'; t.textContent=r.title;
        const s=document.createElement('div'); s.className='row-scroll'; r.apps.forEach(a=>s.appendChild(createCard(a)));
        div.appendChild(t); div.appendChild(s); rowsEl.appendChild(div);
      });
    }
    function openDetails(app){
      document.getElementById('detailsPoster').src=app.poster;
      document.getElementById('detailsTitle').textContent=app.title;
      document.getElementById('detailsDev').textContent=app.dev;
      document.getElementById('detailsDesc').textContent=app.desc;
      document.getElementById('installLink').href=app.url;
      document.getElementById('details').style.display='flex';
    }
    document.addEventListener('keydown',e=>{
      if(e.key==='Escape'||e.key==='Backspace')document.getElementById('details').style.display='none';
    });
    document.getElementById('details').onclick=(e)=>{if(e.target.id==='details')e.target.style.display='none';};
    loadData();
  </script>
</body>
</html>